define(["jquery"],function(a){function b(){a("textarea.edit_code").each(d)}function c(b){a(document.getElementById(b)).each(d)}function d(){var b=13,c=9;a(this).keydown(function(a){if(!(window.hasOwnProperty("behattesting")&&window.behattesting||void 0!==a.which&&0===a.which))if(a.keyCode==c)(a.shiftKey||e(this,"    "))&&a.preventDefault();else if(a.keyCode===b&&void 0!==this.selectionStart){for(var d=this.value.substring(0,this.selectionStart),f=d.lastIndexOf("\n"),g=d.substring(f+1),h="",i=0;i<g.length&&" "===g.charAt(i);i++)h+=" ";e(this,"\n"+h)&&a.preventDefault()}})}function e(a,b){if(void 0!==a.selectionStart){var c=a.value.substring(0,a.selectionStart),d=a.selectionEnd,e=a.value.substring(a.selectionEnd,a.value.length),f=a.scrollTop;a.value=c+b+e;var g=d+b.length;return a.selectionStart=g,a.selectionEnd=g,a.scrollTop=f,!0}if(document.selection&&document.selection.createRange){var h=document.selection.createRange(),i=h.duplicate();return i.moveToElementText(a),i.setEndPoint("EndToEnd",h),h.text=b,!0}return!1}return{setupAllTAs:b,initQuestionTA:c}});