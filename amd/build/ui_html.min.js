define(["jquery"],function(a){function b(b,c,d,e){this.html=e.html,this.textArea=a(document.getElementById(b)),this.readOnly=this.textArea.prop("readonly"),this.templateParams=e,this.fail=!1,this.htmlDiv=null,this.fields=null,this.reload()}return b.prototype.failed=function(){return this.fail},b.prototype.getElement=function(){return this.htmlDiv},b.prototype.getFields=function(){return null===this.fields&&(this.fields=a(this.htmlDiv).find(".coderunner-ui-element")),this.fields},b.prototype.reload=function(){var b,c,d=a(this.textArea).val();if(this.htmlDiv=a("<div style='height:fit-content'>"+this.html+"</div>"),d)try{b=JSON.parse(d),this.getFields().each(function(){c=a(this).attr("name"),b.hasOwnProperty(c)&&a(this).val(b[c])})}catch(e){alert("Failed to initialise HTML UI"),this.fail=!0}},b.prototype.resize=function(){},b.prototype.hasFocus=function(){var a=!1;return this.getFields().each(function(){this===document.activeElement&&(a=!0)}),a},b.prototype.destroy=function(){var b,c={},d=!0;this.getFields().each(function(){var e;b=a(this).attr("name"),e=a(this).val(),""!==e&&""!==b&&(c[b]=e,d=!1)}),d?this.textArea.val(""):this.textArea.val(JSON.stringify(c)),a(this.htmlDiv).remove(),this.htmlDiv=null},{Constructor:b}});