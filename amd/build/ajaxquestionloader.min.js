define(["jquery"],function(a){function b(a){m=!0,o.getPage(a).then(function(c){var d=c.getViewport({scale:q});h.height=d.height,h.width=d.width;var e={canvasContext:l,viewport:d},f=c.render(e);f.promise.then(function(){m=!1,g.html(""+a),null!==p&&(b(p),p=null)})})}function c(a){m?p=a:b(a)}function d(){r<=1||(r--,c(r))}function e(){r>=o.numPages||(r++,c(r))}function f(c,f){var m,p=a("#"+f);return 1!=p.length?void window.alert("Can't load question text. Expected div not found"):(m='<div>\n<button type="button" class="qtype_coderunner_previous">Previous</button>\n<button type="button" class="qtype_coderunner_next">Next</button>&nbsp; &nbsp;<span>Page: <span class="qtype_coderunner_pagenum"></span> / <span class="qtype_coderunner_numpages"></span></span>\n</div>\n<canvas id="qtype_coderunner_problemspec_'+c+'"></canvas>\n</div>\n',p.append(m),h=document.getElementById("qtype_coderunner_problemspec_"+c),i=a("#"+f+" button.qtype_coderunner_next"),j=a("#"+f+" button.qtype_coderunner_previous"),g=a("#"+f+" span.qtype_coderunner_pagenum"),k=a("#"+f+" span.qtype_coderunner_numpages"),l=h.getContext("2d"),i.click(e),j.click(d),void a.getJSON(M.cfg.wwwroot+"/question/type/coderunner/problemspec.php",{questionid:c,sesskey:M.cfg.sesskey},function(a){var c,d;a.filecontentsb64?(c=atob(a.filecontentsb64),d=n.getDocument({data:c}),d.promise.then(function(a){o=a,k.html(""+a.numPages),b(1)})):window.alert("Bad response object")}).fail(function(){window.alert("Failed to load problem spec")}))}var g,h,i,j,k,l,m,n=window["pdfjs-dist/build/pdf"],o=null,m=!1,p=null,q=1.2,r=1;return n.GlobalWorkerOptions.workerSrc="//mozilla.github.io/pdf.js/build/pdf.worker.js",{loadQuestionText:f}});